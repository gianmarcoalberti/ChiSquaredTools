---
name: chisqstrata2x2
title: Stratified Analysis (2×2×K)
menuGroup: Chi² Tools
menuTitle: Stratified Analysis (2×2×K)
version: '1.0.0'
jas: '1.2'
description:
    main: |
        Comprehensive stratified analysis of 2×2 contingency tables for assessing
        conditional independence and homogeneity of odds ratios across strata.
        
        For tables larger than 2×2, use the dedicated "Stratified Analysis (R×C×K)" 
        facility, which provides Cramér's V corrected and log-linear homogeneity tests.
        
        This facility performs a holistic diagnostic procedure that automatically
        runs all core tests required for proper interpretation:
        
        - Stratum-specific odds ratios with 95% confidence intervals
        - Chi-squared tests for each partial table and the marginal table
        - Cochran-Mantel-Haenszel (CMH) test for conditional independence
        - Mantel-Haenszel (MH) test for homogeneity of odds ratios
        - Breslow-Day-Tarone (BDT) test for homogeneity of odds ratios
        
        The analysis provides automated interpretation based on four diagnostic
        scenarios that consider the joint pattern of test results. When cell counts
        contain zeros, the Haldane-Anscombe correction (adding 0.5 to all cells)
        is applied for odds ratio calculations and MH weights.
        
        This facility requires 2×2 tables only (both row and column variables
        must have exactly two levels).
        
    R:
        usage: |
            # Example with Titanic survival data
            # Create a data frame with Class as stratifying variable
            
            titanic_df <- data.frame(
                Survival = factor(c(rep("Yes", 6), rep("No", 6))),
                Gender = factor(rep(c("Female", "Female", "Female", 
                                      "Male", "Male", "Male"), 2)),
                Class = factor(rep(c("1st", "2nd", "3rd"), 4)),
                Count = c(118, 146, 418, 5, 12, 110,
                          61, 25, 75, 139, 94, 106)
            )
            
            ChiSquaredTools::chisqstrata(
                data = titanic_df,
                rows = 'Survival',
                cols = 'Gender',
                strata = 'Class',
                counts = 'Count'
            )

completeWhenFilled: true

options:
    - name: data
      type: Data
      description:
          R: the data as a data frame

    - name: rows
      title: Row Variable
      type: Variable
      suggested:
        - nominal
        - ordinal
      permitted:
        - factor
      description:
          R: >
            a string naming the variable for rows in the 2×2 tables
            (must be a factor with exactly 2 levels)

    - name: cols
      title: Column Variable
      type: Variable
      suggested:
        - nominal
        - ordinal
      permitted:
        - factor
      description:
          R: >
            a string naming the variable for columns in the 2×2 tables
            (must be a factor with exactly 2 levels)

    - name: strata
      title: Stratifying Variable
      type: Variable
      suggested:
        - nominal
        - ordinal
      permitted:
        - factor
      description:
          R: >
            a string naming the stratifying variable; each level defines
            one 2×2 partial table (must be a factor with 2 or more levels)

    - name: counts
      title: Counts (optional)
      type: Variable
      suggested:
        - continuous
      description:
          R: >
            optional variable containing frequency counts for aggregated data.
            If not provided, data are assumed to be in long format (one row per case).

    - name: rowRef
      title: Row category of interest
      type: Level
      variable: (rows)
      description:
          ui: Select the row category to use as the category of interest for odds ratio calculation.
          R: The row level selected as the category of interest.

    - name: colRef
      title: Column category of interest
      type: Level
      variable: (cols)
      description:
          ui: Select the column category to use as the category of interest for odds ratio calculation.
          R: The column level selected as the category of interest.

    - name: showORAnnotation
      title: Show odds ratio interpretation beneath tables
      type: Bool
      default: true
      description:
          R: >
            TRUE or FALSE (default: TRUE), display a plain-language interpretation
            of the odds ratio beneath each partial table and the marginal table.

    - name: showPartialChiSq
      title: Show stratum-specific chi-squared results
      type: Bool
      default: true
      description:
          R: >
            TRUE or FALSE (default: TRUE), display chi-squared test results
            for each partial table in addition to the summary.

    - name: showForestPlot
      title: Display forest plot of odds ratios
      type: Bool
      default: true
      description:
          R: >
            TRUE or FALSE (default: TRUE), display a forest plot showing
            stratum-specific odds ratios with 95% confidence intervals and
            the common Mantel-Haenszel odds ratio.

    - name: showDiagnosticSummary
      title: Show diagnostic summary
      type: Bool
      default: true
      description:
          R: >
            TRUE or FALSE (default: TRUE), display a textual summary
            of the analytical outcome.

    - name: strataOrdered
      title: Treat stratifying variable as ordered
      type: Bool
      default: false
      description:
          R: >
            TRUE or FALSE (default: FALSE), treat the stratifying variable
            as having a natural ordering. When enabled, allows trajectory
            plot visualisation and ordered axis labels.

    - name: showTrajectoryPlot
      title: Display OR trajectory plot (if strata ordered)
      type: Bool
      default: true
      description:
          R: >
            TRUE or FALSE (default: TRUE), display an odds ratio trajectory
            plot when the stratifying variable is marked as ordered.

    - name: showInterpretation
      title: Show interpretation guide
      type: Bool
      default: true
      description:
          R: >
            TRUE or FALSE (default: TRUE), display the detailed interpretation
            guide based on the pattern of test results.

    - name: showMethodInfo
      title: Show detailed method explanations
      type: Bool
      default: false
      description:
          R: >
            TRUE or FALSE (default: FALSE), display detailed methodological 
            explanations for all tests performed.
...